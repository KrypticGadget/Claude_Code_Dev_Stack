<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Code Dev Stack V3+ Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body {
            background-color: #0d1117;
            color: #c9d1d9;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        .navbar-dark {
            background-color: #161b22 !important;
            border-bottom: 1px solid #30363d;
        }
        
        .card {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
        }
        
        .card-header {
            background-color: #21262d;
            border-bottom: 1px solid #30363d;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-healthy { background-color: #238636; }
        .status-warning { background-color: #d29922; }
        .status-critical { background-color: #da3633; }
        .status-unknown { background-color: #6e7681; }
        
        .metric-card {
            transition: transform 0.2s;
        }
        
        .metric-card:hover {
            transform: translateY(-2px);
        }
        
        .progress {
            background-color: #21262d;
        }
        
        .table-dark {
            --bs-table-bg: #161b22;
            --bs-table-border-color: #30363d;
        }
        
        .alert {
            border: none;
            border-radius: 8px;
        }
        
        .alert-info { background-color: #0969da; }
        .alert-warning { background-color: #d29922; }
        .alert-danger { background-color: #da3633; }
        .alert-success { background-color: #238636; }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .log-entry {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.85em;
            padding: 4px 8px;
            margin: 2px 0;
            background-color: #21262d;
            border-left: 3px solid #30363d;
            border-radius: 0 4px 4px 0;
        }
        
        .badge {
            font-size: 0.75em;
        }
        
        .btn-outline-light:hover {
            background-color: #21262d;
            border-color: #30363d;
        }
        
        .nav-tabs .nav-link {
            color: #8b949e;
            background-color: transparent;
            border: 1px solid transparent;
        }
        
        .nav-tabs .nav-link.active {
            color: #c9d1d9;
            background-color: #161b22;
            border-color: #30363d #30363d #161b22;
        }
        
        .tab-content {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-top: none;
            border-radius: 0 0 8px 8px;
            padding: 20px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-robot me-2"></i>
                Claude Code Dev Stack V3+
            </a>
            <div class="navbar-nav ms-auto">
                <div class="nav-item">
                    <span class="nav-link">
                        <span class="status-indicator" id="connection-status"></span>
                        <span id="connection-text">Connecting...</span>
                    </span>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid py-4">
        <!-- System Status Row -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-heartbeat me-2"></i>
                            System Status
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-3">
                                <div class="metric-card p-3">
                                    <div class="display-6" id="system-status">
                                        <span class="status-indicator status-unknown"></span>
                                        Unknown
                                    </div>
                                    <small class="text-muted">Overall Status</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-card p-3">
                                    <div class="h3" id="uptime">-</div>
                                    <small class="text-muted">System Uptime</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-card p-3">
                                    <div class="h3" id="last-update">-</div>
                                    <small class="text-muted">Last Update</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="metric-card p-3">
                                    <div class="h3" id="active-alerts">0</div>
                                    <small class="text-muted">Active Alerts</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Metrics Row -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-microchip me-2"></i>
                            CPU Usage
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="progress mb-2" style="height: 10px;">
                            <div class="progress-bar" id="cpu-progress" style="width: 0%"></div>
                        </div>
                        <small class="text-muted" id="cpu-text">0%</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-memory me-2"></i>
                            Memory Usage
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="progress mb-2" style="height: 10px;">
                            <div class="progress-bar" id="memory-progress" style="width: 0%"></div>
                        </div>
                        <small class="text-muted" id="memory-text">0%</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-hdd me-2"></i>
                            Disk Usage
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="progress mb-2" style="height: 10px;">
                            <div class="progress-bar" id="disk-progress" style="width: 0%"></div>
                        </div>
                        <small class="text-muted" id="disk-text">0%</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Tabs -->
        <div class="row">
            <div class="col-12">
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#overview">
                            <i class="fas fa-chart-line me-2"></i>Overview
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#agents">
                            <i class="fas fa-robot me-2"></i>Agents
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#hooks">
                            <i class="fas fa-cogs me-2"></i>Hooks
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#performance">
                            <i class="fas fa-tachometer-alt me-2"></i>Performance
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#security">
                            <i class="fas fa-shield-alt me-2"></i>Security
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" data-bs-toggle="tab" data-bs-target="#logs">
                            <i class="fas fa-file-alt me-2"></i>Logs
                        </button>
                    </li>
                </ul>

                <div class="tab-content">
                    <!-- Overview Tab -->
                    <div class="tab-pane fade show active" id="overview">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="resource-chart"></canvas>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="performance-chart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-4">
                            <div class="col-md-6">
                                <h6>Claude Code Metrics</h6>
                                <div class="row text-center">
                                    <div class="col-6">
                                        <div class="h4" id="total-operations">0</div>
                                        <small class="text-muted">Total Operations</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="h4" id="total-tokens">0</div>
                                        <small class="text-muted">Tokens Used</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Recent Alerts</h6>
                                <div id="recent-alerts">
                                    <p class="text-muted">No recent alerts</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Agents Tab -->
                    <div class="tab-pane fade" id="agents">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h3" id="total-agents">0</div>
                                        <small class="text-muted">Total Agents</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h3" id="active-agents">0</div>
                                        <small class="text-muted">Active Agents</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-dark table-striped">
                                <thead>
                                    <tr>
                                        <th>Agent Name</th>
                                        <th>Status</th>
                                        <th>Executions</th>
                                        <th>Last Used</th>
                                        <th>File Size</th>
                                    </tr>
                                </thead>
                                <tbody id="agents-table">
                                    <tr>
                                        <td colspan="5" class="text-center text-muted">Loading...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Hooks Tab -->
                    <div class="tab-pane fade" id="hooks">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h3" id="total-hooks">0</div>
                                        <small class="text-muted">Total Hooks</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h3" id="enabled-hooks">0</div>
                                        <small class="text-muted">Enabled Hooks</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-dark table-striped">
                                <thead>
                                    <tr>
                                        <th>Hook Name</th>
                                        <th>Status</th>
                                        <th>File Size</th>
                                        <th>Last Modified</th>
                                    </tr>
                                </thead>
                                <tbody id="hooks-table">
                                    <tr>
                                        <td colspan="4" class="text-center text-muted">Loading...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Performance Tab -->
                    <div class="tab-pane fade" id="performance">
                        <div class="row mb-4">
                            <div class="col-md-3">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h4" id="avg-execution-time">0s</div>
                                        <small class="text-muted">Avg Execution Time</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h4" id="peak-memory">0%</div>
                                        <small class="text-muted">Peak Memory</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h4" id="performance-issues">0</div>
                                        <small class="text-muted">Issues Detected</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="h4" id="operations-count">0</div>
                                        <small class="text-muted">Operations</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="performance-timeline-chart"></canvas>
                        </div>
                    </div>

                    <!-- Security Tab -->
                    <div class="tab-pane fade" id="security">
                        <div class="row mb-4">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="mb-0">Security Status</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row text-center">
                                            <div class="col-md-3">
                                                <div id="security-status-badge" class="h4">
                                                    <span class="badge bg-secondary">Unknown</span>
                                                </div>
                                                <small class="text-muted">Security Status</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="h4" id="total-security-issues">0</div>
                                                <small class="text-muted">Total Issues</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="h4" id="files-scanned">0</div>
                                                <small class="text-muted">Files Scanned</small>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="h4" id="last-scan">Never</div>
                                                <small class="text-muted">Last Scan</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="security-issues">
                            <p class="text-muted">Loading security information...</p>
                        </div>
                    </div>

                    <!-- Logs Tab -->
                    <div class="tab-pane fade" id="logs">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <button class="btn btn-outline-light btn-sm" onclick="refreshLogs()">
                                    <i class="fas fa-sync-alt me-2"></i>Refresh
                                </button>
                            </div>
                            <div class="col-md-6 text-end">
                                <span class="text-muted" id="logs-count">0 log entries</span>
                            </div>
                        </div>
                        
                        <div id="logs-container" style="max-height: 500px; overflow-y: auto;">
                            <p class="text-muted">Loading logs...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // WebSocket connection
        const socket = io();
        
        // Charts
        let resourceChart;
        let performanceChart;
        let timelineChart;
        
        // Connection status
        socket.on('connect', function() {
            document.getElementById('connection-status').className = 'status-indicator status-healthy';
            document.getElementById('connection-text').textContent = 'Connected';
        });
        
        socket.on('disconnect', function() {
            document.getElementById('connection-status').className = 'status-indicator status-critical';
            document.getElementById('connection-text').textContent = 'Disconnected';
        });
        
        // Status updates
        socket.on('status_update', function(data) {
            updateSystemStatus(data);
        });
        
        // Metrics updates
        socket.on('metrics_update', function(data) {
            updateMetrics(data);
        });
        
        // Alert updates
        socket.on('new_alert', function(alert) {
            addAlert(alert);
        });
        
        // Initialize dashboard
        function initDashboard() {
            loadAllData();
            initCharts();
            
            // Auto-refresh every 30 seconds
            setInterval(loadAllData, 30000);
        }
        
        // Load all data
        function loadAllData() {
            fetch('/api/status').then(r => r.json()).then(updateSystemStatus);
            fetch('/api/metrics').then(r => r.json()).then(updateMetrics);
            fetch('/api/agents').then(r => r.json()).then(updateAgents);
            fetch('/api/hooks').then(r => r.json()).then(updateHooks);
            fetch('/api/performance').then(r => r.json()).then(updatePerformance);
            fetch('/api/security').then(r => r.json()).then(updateSecurity);
            fetch('/api/logs').then(r => r.json()).then(updateLogs);
            fetch('/api/alerts').then(r => r.json()).then(updateAlerts);
        }
        
        // Update system status
        function updateSystemStatus(data) {
            const statusElement = document.getElementById('system-status');
            const status = data.status || 'unknown';
            
            statusElement.innerHTML = `
                <span class="status-indicator status-${status}"></span>
                ${status.charAt(0).toUpperCase() + status.slice(1)}
            `;
            
            document.getElementById('uptime').textContent = data.uptime || '-';
            
            if (data.last_update) {
                const lastUpdate = new Date(data.last_update);
                document.getElementById('last-update').textContent = lastUpdate.toLocaleTimeString();
            }
        }
        
        // Update metrics
        function updateMetrics(data) {
            if (data.system) {
                updateProgressBar('cpu', data.system.cpu_percent);
                updateProgressBar('memory', data.system.memory_percent);
                updateProgressBar('disk', data.system.disk_percent);
            }
            
            if (data.claude_code) {
                document.getElementById('total-operations').textContent = data.claude_code.total_operations;
                document.getElementById('total-tokens').textContent = data.claude_code.total_tokens_used.toLocaleString();
            }
        }
        
        // Update progress bar
        function updateProgressBar(type, value) {
            const progress = document.getElementById(`${type}-progress`);
            const text = document.getElementById(`${type}-text`);
            
            progress.style.width = `${value}%`;
            text.textContent = `${value.toFixed(1)}%`;
            
            // Update color based on value
            progress.className = 'progress-bar';
            if (value > 90) {
                progress.classList.add('bg-danger');
            } else if (value > 70) {
                progress.classList.add('bg-warning');
            } else {
                progress.classList.add('bg-success');
            }
        }
        
        // Update agents
        function updateAgents(data) {
            document.getElementById('total-agents').textContent = data.total_agents;
            document.getElementById('active-agents').textContent = data.active_agents;
            
            const tbody = document.getElementById('agents-table');
            tbody.innerHTML = '';
            
            data.agents.forEach(agent => {
                const row = document.createElement('tr');
                const status = agent.last_used ? 'Active' : 'Inactive';
                const statusClass = agent.last_used ? 'text-success' : 'text-muted';
                const lastUsed = agent.last_used ? new Date(agent.last_used).toLocaleString() : 'Never';
                const fileSize = (agent.file_size / 1024).toFixed(1) + ' KB';
                
                row.innerHTML = `
                    <td>${agent.name}</td>
                    <td><span class="${statusClass}">${status}</span></td>
                    <td>${agent.executions}</td>
                    <td>${lastUsed}</td>
                    <td>${fileSize}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // Update hooks
        function updateHooks(data) {
            document.getElementById('total-hooks').textContent = data.total_hooks;
            document.getElementById('enabled-hooks').textContent = data.enabled_hooks;
            
            const tbody = document.getElementById('hooks-table');
            tbody.innerHTML = '';
            
            data.hooks.forEach(hook => {
                const row = document.createElement('tr');
                const status = hook.enabled ? 'Enabled' : 'Disabled';
                const statusClass = hook.enabled ? 'text-success' : 'text-warning';
                const fileSize = (hook.file_size / 1024).toFixed(1) + ' KB';
                const modified = new Date(hook.modified * 1000).toLocaleString();
                
                row.innerHTML = `
                    <td>${hook.name}</td>
                    <td><span class="${statusClass}">${status}</span></td>
                    <td>${fileSize}</td>
                    <td>${modified}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // Update performance
        function updatePerformance(data) {
            if (data.summary) {
                document.getElementById('avg-execution-time').textContent = `${data.summary.average_execution_time || 0}s`;
                document.getElementById('peak-memory').textContent = `${data.summary.peak_memory_usage || 0}%`;
                document.getElementById('performance-issues').textContent = data.summary.issues_detected || 0;
                document.getElementById('operations-count').textContent = data.summary.total_operations || 0;
            }
            
            // Update timeline chart if data available
            if (data.resource_timeline && timelineChart) {
                updateTimelineChart(data.resource_timeline);
            }
        }
        
        // Update security
        function updateSecurity(data) {
            const statusBadge = document.getElementById('security-status-badge');
            let badgeClass = 'bg-secondary';
            let statusText = 'Unknown';
            
            if (data.status) {
                switch (data.status) {
                    case 'secure':
                        badgeClass = 'bg-success';
                        statusText = 'Secure';
                        break;
                    case 'warning':
                        badgeClass = 'bg-warning';
                        statusText = 'Warning';
                        break;
                    case 'critical':
                        badgeClass = 'bg-danger';
                        statusText = 'Critical';
                        break;
                    case 'attention':
                        badgeClass = 'bg-info';
                        statusText = 'Attention';
                        break;
                }
            }
            
            statusBadge.innerHTML = `<span class="badge ${badgeClass}">${statusText}</span>`;
            
            document.getElementById('total-security-issues').textContent = data.total_issues || 0;
            document.getElementById('files-scanned').textContent = data.files_scanned || 0;
            
            if (data.last_scan) {
                document.getElementById('last-scan').textContent = new Date(data.last_scan).toLocaleString();
            }
            
            // Show recent issues
            const issuesContainer = document.getElementById('security-issues');
            if (data.recent_issues && data.recent_issues.length > 0) {
                issuesContainer.innerHTML = '<h6>Recent Issues:</h6>';
                data.recent_issues.forEach(issue => {
                    const alertClass = issue.severity === 'HIGH' ? 'alert-danger' : 
                                     issue.severity === 'MEDIUM' ? 'alert-warning' : 'alert-info';
                    
                    issuesContainer.innerHTML += `
                        <div class="alert ${alertClass} alert-dismissible fade show">
                            <strong>${issue.file}:${issue.line}</strong> - ${issue.description}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    `;
                });
            } else {
                issuesContainer.innerHTML = '<p class="text-muted">No recent security issues</p>';
            }
        }
        
        // Update logs
        function updateLogs(data) {
            const container = document.getElementById('logs-container');
            const count = document.getElementById('logs-count');
            
            count.textContent = `${data.logs ? data.logs.length : 0} log entries`;
            
            if (data.logs && data.logs.length > 0) {
                container.innerHTML = '';
                data.logs.forEach(log => {
                    const logEntry = document.createElement('div');
                    logEntry.className = 'log-entry';
                    logEntry.innerHTML = `
                        <small class="text-muted">[${log.file}]</small> ${log.content}
                    `;
                    container.appendChild(logEntry);
                });
            } else {
                container.innerHTML = '<p class="text-muted">No log entries found</p>';
            }
        }
        
        // Update alerts
        function updateAlerts(data) {
            document.getElementById('active-alerts').textContent = data.count || 0;
            
            const alertsContainer = document.getElementById('recent-alerts');
            if (data.alerts && data.alerts.length > 0) {
                alertsContainer.innerHTML = '';
                data.alerts.slice(-5).forEach(alert => {
                    addAlert(alert);
                });
            }
        }
        
        // Add alert
        function addAlert(alert) {
            const container = document.getElementById('recent-alerts');
            const alertClass = alert.level === 'error' ? 'alert-danger' : 
                              alert.level === 'warning' ? 'alert-warning' : 'alert-info';
            
            const alertElement = document.createElement('div');
            alertElement.className = `alert ${alertClass} alert-sm`;
            alertElement.innerHTML = `
                <small>${new Date(alert.timestamp).toLocaleTimeString()}</small><br>
                ${alert.message}
            `;
            
            container.insertBefore(alertElement, container.firstChild);
            
            // Keep only last 5 alerts visible
            while (container.children.length > 5) {
                container.removeChild(container.lastChild);
            }
        }
        
        // Initialize charts
        function initCharts() {
            // Resource chart
            const resourceCtx = document.getElementById('resource-chart').getContext('2d');
            resourceChart = new Chart(resourceCtx, {
                type: 'doughnut',
                data: {
                    labels: ['CPU', 'Memory', 'Disk'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: ['#da3633', '#d29922', '#238636']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#c9d1d9' }
                        }
                    }
                }
            });
            
            // Performance timeline chart
            const timelineCtx = document.getElementById('performance-timeline-chart').getContext('2d');
            timelineChart = new Chart(timelineCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'CPU %',
                        data: [],
                        borderColor: '#da3633',
                        tension: 0.4
                    }, {
                        label: 'Memory %',
                        data: [],
                        borderColor: '#d29922',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#c9d1d9' }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#c9d1d9' },
                            grid: { color: '#30363d' }
                        },
                        y: {
                            ticks: { color: '#c9d1d9' },
                            grid: { color: '#30363d' }
                        }
                    }
                }
            });
        }
        
        // Update timeline chart
        function updateTimelineChart(data) {
            if (!timelineChart || !data.timestamps) return;
            
            timelineChart.data.labels = data.timestamps.map(t => new Date(t).toLocaleTimeString());
            timelineChart.data.datasets[0].data = data.cpu_usage;
            timelineChart.data.datasets[1].data = data.memory_usage;
            timelineChart.update();
        }
        
        // Refresh logs
        function refreshLogs() {
            fetch('/api/logs').then(r => r.json()).then(updateLogs);
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>