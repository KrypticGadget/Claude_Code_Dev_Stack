# Claude Code Dev Stack - Complete Windows Installation
# This script installs both agents and slash commands

Write-Host @"
ü§ñ Claude Code Agent System - Complete Installation
   Transform Natural Language into Production Software
   28 Specialized AI Agents + 18 Slash Commands
"@ -ForegroundColor Cyan

Write-Host "`nThis will install:" -ForegroundColor Yellow
Write-Host "  ‚úì 28 AI agents for full-stack development" -ForegroundColor White
Write-Host "  ‚úì 18 slash commands for quick access" -ForegroundColor White
Write-Host "  ‚úì Master prompts and templates" -ForegroundColor White
Write-Host "  ‚úì PowerShell aliases (optional)" -ForegroundColor White

# Download and run the installation scripts
$TEMP_DIR = "$env:TEMP\claude-code-install"
New-Item -ItemType Directory -Force -Path $TEMP_DIR | Out-Null

try {
    # Download install.ps1
    Write-Host "`nüì• Downloading installation scripts..." -ForegroundColor Green
    $installUrl = "https://raw.githubusercontent.com/KrypticGadget/Claude_Code_Dev_Stack/main/install.ps1"
    $commandsUrl = "https://raw.githubusercontent.com/KrypticGadget/Claude_Code_Dev_Stack/main/install-commands.ps1"
    
    # For now, we'll use the scripts we just created inline
    # In your repo, you would upload these as install.ps1 and install-commands.ps1
    
    Write-Host "`nüöÄ Running agents installation..." -ForegroundColor Yellow
    # Run the agents installation (content from first artifact)
    
    Write-Host "`nüöÄ Running slash commands installation..." -ForegroundColor Yellow
    # Run the commands installation (content from second artifact)
    
    Write-Host "`n‚úÖ Complete installation finished!" -ForegroundColor Green
    Write-Host "`nüìö Next steps:" -ForegroundColor Cyan
    Write-Host "1. Set your API key: claude-code set-key" -ForegroundColor White
    Write-Host "2. Start a project: claude-code `"/new-project Your idea here`"" -ForegroundColor White
    Write-Host "3. Check quick reference: $env:USERPROFILE\.claude-code\QUICK_REFERENCE.txt" -ForegroundColor White
    
} catch {
    Write-Host "`n‚ùå Installation failed: $_" -ForegroundColor Red
}

# Quick one-liner for README
Write-Host "`nüìã For future installations, you can use this one-liner:" -ForegroundColor Gray
Write-Host 'iwr -useb https://raw.githubusercontent.com/KrypticGadget/Claude_Code_Dev_Stack/main/install-all.ps1 | iex' -ForegroundColor White